



### **Part 1: Host Discovery**

#### **A. Professional Summary **

**Objective:** Host Discovery is the critical first phase of active reconnaissance, focused on identifying live hosts within a target network range. This process is essential for mapping the attack surface and optimizing subsequent, more intensive scanning phases.

**Strategic Approach:** Effective host discovery is not reliant on a single technique but on a versatile methodology adapted to the target environment. The core strategy involves bypassing network filtering (firewalls, IDS) by employing a variety of probes.

* **For Local Area Networks (LAN):** The **ARP Scan (`-PR`)** is the most reliable and efficient method, operating at Layer 2 to accurately identify all active devices.
* **For Wide Area Networks (WAN):** A multi-pronged approach is necessary. While a standard **ICMP Echo Ping (`-PE`)** is often blocked, techniques like **TCP SYN/ACK Pings (`-PS`/`-PA`)** are highly effective as they mimic legitimate network traffic (e.g., web requests) that firewalls are configured to allow. For more heavily filtered environments, obscure probes such as **ICMP Timestamp/Address Mask Pings (`-PP`/`-PM`)** and **IP Protocol Scans (`-PO`)** can uncover hosts by leveraging less common, often unmonitored protocols.

This multi-faceted approach ensures a comprehensive and stealthy enumeration of live targets, forming a solid foundation for the subsequent port scanning and vulnerability analysis stages.

---





## B. Personal Deep Dive Notes 

---

### **۱. ARP Ping Scan (`-PR`)**

> **برداشت من:** این روش در شبکه محلی (LAN) بسیار خوب و مطمئن است، چون اکثر فایروال‌ها درخواست ARP را بلاک نمی‌کنند.

🧠 **یادآوری با مثال (Analogy):**
این تکنیک مثل این است که وارد یک اتاق شوی و با صدای بلند بپرسی **"هرکس که اینجا هست، لطفاً اسم و مشخصاتش رو بگه!"**. چون همه در یک فضای مشترک (شبکه محلی) هستند و برای ارتباط با یکدیگر به این مکانیزم نیاز دارند، تقریباً همه مجبور به پاسخ دادن هستند.

⚙️ **منطق فنی و استراتژی:**
این اسکن در **لایه ۲ شبکه (Data Link)** کار می‌کند، یعنی حتی قبل از اینکه IP (لایه ۳) وارد ماجرا شود. پروتکل ARP (Address Resolution Protocol) برای ترجمه آدرس‌های IP به آدرس‌های فیزیکی MAC ضروری است. هیچ دستگاهی نمی‌تواند در یک شبکه محلی بدون پاسخ به درخواست‌های ARP به درستی کار کند. به همین دلیل، مسدود کردن آن توسط فایروال‌های روی سیستم‌ها بسیار نادر است، چون این کار عملاً ارتباط دستگاه با شبکه را قطع می‌کند. به همین خاطر این روش **سریع‌ترین و قابل اعتمادترین** راه برای شناسایی تمام دستگاه‌های فعال در یک شبکه محلی است.

챌 **نکته کلیدی/چالش:**
در تست اولیه، این اسکن نتوانست گوشی موبایل متصل به شبکه را پیدا کند. دلیل اصلی، **حالت‌های ذخیره انرژی (Power-Saving Mode)** در گوشی‌هاست. وقتی صفحه گوشی خاموش است، کارت شبکه وای‌فای برای صرفه‌جویی در باتری به حالت "چرت" می‌رود و به درخواست‌های عمومی (Broadcast) مثل ARP پاسخ نمی‌دهد. این یک درس مهم است: نتایج اسکن همیشه تصویری از یک لحظه خاص هستند و ممکن است به دلیل شرایط هدف، کامل نباشند.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sn -PR 192.168.1.0/24`

---

### **۲. TCP SYN Ping (`-PS`)**

> **برداشت من:** یکی از مهم‌ترین و قدرتمندترین ابزارها برای کشف سیستم در اینترنت. این متد یک پکت SYN می‌فرستد و شروع یک دست دادن سه مرحله‌ای را رقم می‌زند. هاست یا می‌خواهد ارتباط شکل بگیرد و جواب می‌دهد یا می‌خواهد شکل نگیرد و باز هم جواب می‌دهد.

🧠 **یادآوری با مثال:**
تکنیک **"زنگ بزن و فرار کن" (Ding-Dong Ditch)**. ما اولین مرحله از یک ارتباط کاملاً عادی و قانونی (فشردن زنگ / ارسال `SYN`) را انجام می‌دههیم. به محض گرفتن هر نوع واکنشی از داخل خانه (باز شدن در / دریافت `SYN/ACK` یا دادی از پشت در / دریافت `RST`)، ما به هدفمان رسیده‌ایم و بلافاصله فرار می‌کنیم (ارسال `RST` برای قطع ارتباط).

⚙️ **منطق فنی و استراتژی:**
این روش یک بسته TCP با فلگ `SYN` به یک پورت مشخص (پیش‌فرض پورت ۸۰) ارسال می‌کند.
* **اگر پورت باز باشد:** سیستم هدف با یک بسته `SYN/ACK` پاسخ می‌دهد.
* **اگر پورت بسته باشد:** سیستم هدف با یک بسته `RST` پاسخ می‌دهد.
در هر دو حالت، ما یک **پاسخ مستقیم** از هدف دریافت کرده‌ایم که فعال بودن آن را با قطعیت ۱۰۰٪ تایید می‌کند. استراتژی کلیدی در اینجا، استفاده از پورت‌های رایجی مثل **۸۰ (HTTP)** و **۴۴۳ (HTTPS)** است. چرا؟ چون تقریباً هیچ فایروالی در دنیا ترافیک خروجی به سمت این پورت‌ها را مسدود نمی‌کند، وگرنه کارمندان آن شرکت نمی‌توانند وب‌گردی کنند! این باعث می‌شود `-PS` یکی از قابل اعتمادترین روش‌ها برای اهداف اینترنتی باشد.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sn -PS80,443,8080 <target>`

---

### **۳. TCP ACK Ping (`-PA`)**

> **برداشت من:** این روش مکملی برای SYN Ping است و به صورت سرزده فلگ تاییدیه می‌فرستد. در تست من، `-PS` جواب داد اما این متود نه، که نشان می‌دهد به تنظیمات فایروال هدف بستگی دارد.

🧠 **یادآوری با مثال:**
تکنیک **"تحویل بسته اشتباهی"**. ما وانمود می‌کنیم که در اواسط یک مکالمه هستیم و یک بسته `ACK` (تاییدیه) برای هدف می‌فرستیم. این مانند این است که یک پستچی بسته‌ای را دم در بیاورد و بگوید "لطفاً رسید تحویل را امضا کنید". صاحب‌خانه که می‌داند چیزی سفارش نداده، با عصبانیت پاسخ می‌دهد "من چیزی سفارش ندادم!" (ارسال `RST`). همین پاسخ عصبانی، وجود او را برای ما تایید می‌کند.

⚙️ **منطق فنی و استراتژی:**
این تکنیک برای فریب دادن **فایروال‌های با وضعیت (Stateful Firewalls)** طراحی شده است. این فایروال‌ها تمام مکالمات را ردیابی می‌کنند و انتظار دارند هر ارتباطی با `SYN` شروع شود. وقتی یک بسته `ACK` تنها و بی‌ربط از راه می‌رسد، برخی فایروال‌های ساده‌تر گیج شده و آن را عبور می‌دهند تا ببینند خود سیستم‌عامل چه واکنشی نشان می‌دهد. سیستم‌عامل طبق قانون موظف است با `RST` پاسخ دهد. شکست این تست در آزمایش شما نشان می‌دهد که فایروال هدف به اندازه کافی هوشمند بوده که هر بسته‌ای که به یک ارتباط فعال تعلق ندارد را مسدود کند.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sn -PA80,443 <target>`

---

### **۴. UDP Ping (`-PU`)**

> **برداشت من:** این روش عمدتاً برای اینترنت است. یک پکت UDP خالی به یک پورت غیرمعقول می‌فرستد و اگر پورت بسته باشد، سیستم پیام "Port Unreachable" برمی‌گرداند. اگر جواب سکوت باشد، ممکن است فایروال بسته را مسدود کرده باشد.

🧠 **یادآوری با مثال:**
تکنیک **"نامه بی‌نام و نشان"**. یک پاکت خالی به یک آدرس پرت و یک واحد غیرموجود در یک ساختمان می‌فرستیم.
* **حالت ۱:** مدیر ساختمان (سیستم‌عامل) نامه را می‌بیند و یک اخطار "چنین واحدی وجود ندارد" (ICMP Port Unreachable) برای اداره پست می‌فرستد. **این پاسخ قطعی، زنده بودن ساختمان را تایید می‌کند.**
* **حالت ۲:** نگهبان ساختمان (فایروال) نامه را می‌بیند و آن را دور می‌اندازد. ما هیچ خبری دریافت نمی‌کنیم. **این سکوت می‌تواند به معنی فعال بودن ساختمان و یا نبودن آن باشد.**

⚙️ **منطق فنی و استراتژی:**
اسکن UDP به دلیل ماهیت غیرقابل اعتماد و بدون اتصال UDP، ذاتا کند و مبهم است. Nmap باید خودش زمان‌بندی و تلاش‌های مجدد را مدیریت کند. نتیجه `open|filtered` دقیقاً به همین ابهام اشاره دارد: "من یک بسته فرستادم و هیچ جوابی نگرفتم. نمی‌دانم پورت باز بود و جواب نداد، یا یک فایروال در مسیر آن را حذف کرد." با این حال، این روش برای دور زدن فایروال‌هایی که فقط ترافیک TCP و ICMP را زیر نظر دارند، مفید است.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sn -PU <target>`

---

### **۵. انواع پینگ ICMP (`-PE`, `-PP`, `-PM`)**

> **برداشت من:** `-PE` همان پینگ معمولی است که اغلب در اینترنت مسدود می‌شود. `-PP` و `-PM` از قابلیت‌های قدیمی ICMP (پرسیدن ساعت و ساب‌نت مسک) استفاده می‌کنند که مدیران شبکه اغلب فراموش می‌کنند آن‌ها را مسدود کنند و این یک نقطه کور برای نفوذ است.

🧠 **یادآوری با مثال:**
این سه تکنیک مانند سه سوال متفاوت از نگهبان دم در هستند:
* **-PE (Echo):** سوال مستقیم: **"علی اونجایی؟"** (اغلب مسدود می‌شود).
* **-PP (Timestamp):** سوال هوشمندانه: **"ببخشید، ساعت چنده؟"** (اغلب مسدود نمی‌شود).
* **-PM (Address Mask):** سوال عجیب و قدیمی: **"نقشه این محله رو داری؟"** (تقریباً هرگز مسدود نمی‌شود).

⚙️ **منطق فنی و استراتژی:**
قدرت این تکنیک‌ها در استفاده از **انواع پیام (Message Types)** مختلف ICMP است.
* `-PE` از پیام نوع **۸ (Echo Request)** استفاده می‌کند که بسیار معروف است.
* `-PP` از پیام نوع **۱۳ (Timestamp Request)** استفاده می‌کند که کمتر شناخته شده است.
* `-PM` از پیام نوع **۱۷ (Address Mask Request)** استفاده می‌کند که تقریباً منسوخ شده است.
استراتژی در اینجا، بهره‌برداری از تنظیمات ناقص فایروال است. مدیر شبکه فقط معروف‌ترین نوع ICMP را مسدود کرده و بقیه را به حال خود رها کرده است.

⚡️ **دستورات (Commands):**
`sudo nmap -sn -PE <target>`
`sudo nmap -sn -PP <target>`
`sudo nmap -sn -PM <target>`

---

### **۶. IP Protocol Ping (`-PO`)**

> **برداشت من:** این متد جالب، هدر IP را به پروتکل‌های ناشناخته تغییر می‌دهد (نه TCP، نه UDP و نه ICMP). فایروال ممکن است نحوه برخورد با این پروتکل‌های خاص را بلد نباشد و اجازه عبور بدهد.

🧠 **یادآوری با مثال:**
تکنیک **"ارسال تلگرام به جای نامه"**. ما فرمت ارتباطی را کاملاً عوض می‌کنیم. نگهبان (فایروال) فقط برای بازرسی نامه‌های استاندارد (TCP/UDP/ICMP) آموزش دیده است. وقتی یک تلگرام با فرمتی کاملاً متفاوت به دستش می‌رسد، نمی‌داند با آن چه کار کند و از روی شک، اجازه عبور می‌دهد.

⚙️ **منطق فنی و استراتژی:**
این روش در **لایه ۳ (IP)** عمل می‌کند. در هدر هر بسته IP، یک فیلد ۸ بیتی به نام "Protocol" وجود دارد که مشخص می‌کند محتوای بسته چیست (مثلاً 6=TCP, 17=UDP, 1=ICMP). Nmap بسته‌هایی با شماره پروتکل‌های دیگر (مثل 2=IGMP یا 4=IP-in-IP) ارسال می‌کند. اگر سیستم هدف با پیام ICMP "Protocol Unreachable" پاسخ دهد، زنده بودن آن تایید می‌شود. این یک تکنیک بسیار پیشرفته برای پیدا کردن نقاط کور در سیاست‌های امنیتی فایروال است که فقط روی پروتکل‌های معروف تمرکز کرده‌اند.



⚡️ **دستور اصلی (Command):**
`sudo nmap -sn -PO <target>`


---








### **Part 2: Port & Service Scanning**

---

#### **A. Professional Summary (for Portfolio)**

**Objective:** This section details the methodologies for enumerating open, closed, and filtered ports on a target host. Port scanning is a foundational phase of penetration testing, used to identify potential attack vectors by mapping the services exposed to the network.

**Strategic Approach:** The choice of scanning technique is dictated by the engagement's rules of engagement, the target environment's security posture, and the need for stealth.

* **Standard Scans:** The **TCP Connect Scan (`-sT`)** is a reliable method that completes the full three-way handshake, but it is easily logged. The **TCP SYN "Stealth" Scan (`-sS`)** is the default and most popular choice, offering a balance of speed and stealth by never completing the TCP connection.
* **Stealth & Firewall Evasion Scans:** Techniques like **FIN (`-sF`)**, **Xmas (`-sX`)**, and **Maimon (`-sM`)** scans attempt to bypass stateless firewalls by sending non-standard flag combinations. However, they are ineffective against modern Windows systems and are easily flagged as anomalies by modern IDS/IPS.
* **Firewall Analysis:** The **TCP ACK Scan (`-sA`)** is not designed to find open ports but is a crucial tool for mapping firewall rule sets by differentiating between `filtered` and `unfiltered` ports.
* **Advanced Stealth:** The **Idle Scan (`-sI`)** offers the ultimate level of stealth by spoofing the scan through an idle "zombie" host, completely obscuring the attacker's true IP address. Its practical use is limited by the difficulty of finding suitable zombie hosts on the modern internet.
* **Non-TCP Scans:** The **UDP Scan (`-sU`)** is essential for enumerating critical but often overlooked services (e.g., DNS, SNMP). It is inherently slow and often ambiguous due to the connectionless nature of UDP. Similarly, the **SCTP INIT (`-sY`)** and **COOKIE ECHO (`-sZ`)** scans are used to audit the less common but important SCTP protocol, prevalent in telecommunication networks.

A proficient penetration tester must master this entire suite of tools to accurately map a target's attack surface under various network conditions.

---

#### **B. Personal Deep Dive Notes (جزوه شخصی برای مرور)**

در این بخش، تمام نکات کلیدی، مثال‌ها و منطق فنی هر تکنیک را برای یادگیری عمیق و مرور آینده ثبت می‌کنم.

---

##### **۱. TCP Connect Scan (`-sT`)**

> **برداشت من:** این روش برای شناسایی پورت‌ها استفاده می‌شود و به شکل عادی برای هر پورت، یک پکت TCP ارسال و دست دادن ۳ مرحله‌ای را کامل انجام می‌دهد. قابل اعتماد است اما سر و صدای زیادی دارد چون همه چیز توی لاگ‌ها به جا می‌ماند. نیاز به دسترسی بالا هم ندارد.

🧠 **یادآوری با مثال (Analogy):**
تکنیک **"مهمان مودب"**. شما به صورت کاملاً رسمی در می‌زنید (`SYN`)، منتظر جواب می‌مانید (`SYN/ACK`)، وارد می‌شوید و دست می‌دهید (`ACK`) و سپس خداحافظی می‌کنید. این کار کاملاً قانونی و قابل مشاهده است.

⚙️ **منطق فنی و استراتژی:**
این اسکن از فراخوانی سیستمی `connect()` سیستم‌عامل استفاده می‌کند. چون یک ارتباط کامل TCP برقرار می‌شود، بسیار قابل اعتماد است اما به راحتی توسط فایروال‌ها و سیستم‌های تشخیص نفوذ (IDS) ثبت (Log) می‌شود. این تنها نوع اسکن TCP است که به دسترسی ریشه (`sudo`) نیاز ندارد و به همین دلیل در شرایطی که دسترسی محدودی داریم، کاربردی است.

⚡️ **دستور اصلی (Command):**
`nmap -sT <target>`

---

##### **۲. TCP Stealth Scan (`-sS`)**

> **برداشت من:** همان متود قبلی است ولی به جای اینکه دست دادن سه‌گانه را کامل انجام دهد، بعد از گرفتن پاسخ، ارتباط را با فلگ ریست، قطع می‌کند. امن‌تر است چون لاگ کمتری برای فایروال‌های قدیمی به جا می‌گذارد و سریع‌تر است.

🧠 **یادآوری با مثال:**
تکنیک **"کارآگاه مخفی"** یا **"زنگ بزن و فرار کن"**. شما فقط دستگیره در را می‌چرخانید (`SYN`). به محض اینکه فهمیدید در باز است (`SYN/ACK`)، دستگیره را رها کرده و فرار می‌کنید (`RST`)، بدون اینکه هرگز وارد اتاق شوید.

⚙️ **منطق فنی و استراتژی:**
این اسکن هرگز دست‌دهی سه‌مرحله‌ای را کامل نمی‌کند. با ارسال `RST` پس از دریافت `SYN/ACK`، از برقراری یک ارتباط کامل جلوگیری می‌کند. این کار هم سرعت را بالا می‌برد و هم باعث می‌شود در سیستم‌های لاگ‌برداری ساده، ردپای کمتری به جا بماند. این روش به دلیل تعادل عالی بین سرعت، دقت و مخفی‌کاری، **حالت پیش‌فرض Nmap در حالت ریشه (sudo)** است.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sS <target>`

---

##### **۳. Xmas Scan (`-sX`)**

> **برداشت من:** پر سر و صداترین اسکن! این اسکن یک پکت TCP با فلگ‌های بی‌ربط می‌فرستد. اگر پورت بسته باشد، یک جواب `RST` به ما می‌رسد و متوجه می‌شویم. اما درباره باز بودنش نمی‌توانیم تصمیم بگیریم چون شاید فایروال جلوی پکت را گرفته باشد. برای سیستم‌های امروزی پیشنهاد نمی‌شود.

🧠 **یادآوری با مثال:**
تکنیک **"نامه عجیب و غریب"**. شما نامه‌ای با ده‌ها تمبر بی‌ربط و همزمان (`FIN`, `PSH`, `URG`) ارسال می‌کنید. این نامه آنقدر عجیب است که در یک شبکه مدرن، مانند روشن کردن پروژکتور روی خودتان عمل می‌کند.
⚙️ **منطق فنی و استراتژی:**
این روش از یک حفره در استاندارد TCP (RFC 793) سوءاستفاده می‌کند که می‌گوید اگر پورتی بسته باشد، باید در پاسخ به بسته‌های نامعتبر `RST` برگرداند. مزیت آن در گذشته، عبور از فایروال‌های ساده بود. اما امروزه، این ترکیب خاص از فلگ‌ها یک **امضای (Signature) شناخته‌شده برای Nmap** است و بلافاصله توسط سیستم‌های امنیتی مدرن شناسایی و مسدود می‌شود. این تکنیک روی ویندوز کار نمی‌کند.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sX <target>`

---

##### **۴. TCP Maimon Scan (`-sM`)**

> **برداشت من:** یک روش منسوخ شده که روی سیستم‌های قدیمی کار می‌کند. یک پکت با فلگ `FIN` و `ACK` می‌فرستد. سیستم‌های جدید همیشه `RST` برمی‌گردانند اما قدیمی‌ها اگر پورت باز باشد، سکوت می‌کنند. قابل اعتماد نیست.

🧠 **یادآوری با مثال:**
تکنیک **"نامه خداحافظی و تایید همزمان"**. یک پیام متناقض که می‌گوید "هم خداحافظ و هم تایید می‌کنم". این روش فقط روی تعداد بسیار محدودی از سیستم‌عامل‌های قدیمی (مبتنی بر BSD) که در مقابل این پیام گیج می‌شدند و سکوت می‌کردند، کار می‌کرد.

⚙️ **منطق فنی و استراتژی:**
این تکنیک امروزه بیشتر ارزش تاریخی و آموزشی دارد و در عمل تقریباً کاربردی ندارد، زیرا تقریباً تمام سیستم‌عامل‌های مدرن به درستی به این بسته پاسخ `RST` می‌دهند و در نتیجه تمام پورت‌ها را `closed` نشان می‌دهند.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sM <target>`

---

##### **۵. TCP ACK Scan (`-sA`)**

> **برداشت من:** این نوع اسکن برای مشخص کردن باز یا بسته بودن پورت نیست و می‌خواهد نشان دهد پورت فیلتر هست یا نه و قدرت فایروال را بسنجد. اگر پورت باز یا بسته باشد، `RST` برمی‌گرداند و می‌فهمیم پکت از فایروال رد شده، اما اگه سکوت کرد یعنی فیلتر شده.

🧠 **یادآوری با مثال:**
تکنیک **"بازرسی نگهبان"**. شما به واکنش خودِ درها اهمیتی نمی‌دهید، بلکه می‌خواهید بفهمید آیا اصلاً یک نگهبان (فایروال) جلوی در ایستاده است یا نه.
⚙️ **منطق فنی و استراتژی:**
هدف این اسکن **ترسیم نقشه قوانین فایروال** است. با ارسال یک بسته `ACK`، اگر پاسخ `RST` دریافت کنیم، یعنی بسته ما از فایروال عبور کرده و پورت `unfiltered` است. اگر پاسخی دریافت نکنیم، یعنی یک فایروال با وضعیت (Stateful) بسته ما را حذف کرده و پورت `filtered` است. این تکنیک به تنهایی پورت باز را پیدا نمی‌کند اما در ترکیب با اسکن‌های دیگر فوق‌العاده مفید است.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sA <target>`

---

##### **۶. Idle Scan (`-sI`)**

> **برداشت من:** این یکی از مخفی‌ترین روش‌هاست چون از یک سیستم واسطه (زامبی) برای اسکن استفاده می‌کنیم. ما با بررسی تغییرات عدد IPID در سیستم زامبی قبل و بعد از ارسال بسته جعلی به هدف، وضعیت پورت را استنباط می‌کنیم.

🧠 **یادآوری با مثال:**
تکنیک **"بازجویی از واسطه"**. ما از یک فرد بی‌خبر که در حال شمردن شماره پلاک ماشین‌هاست (زامبی با IPID افزایشی) سوءاستفاده می‌کنیم تا از یک مجرم (هدف) بازجویی کنیم، بدون اینکه مجرم هرگز ما را ببیند.

⚙️ **منطق فنی و استراتژی:**
این هوشمندانه‌ترین و مخفیانه‌ترین نوع اسکن است که **جعل کامل IP** را انجام می‌دهد. هدف هرگز IP واقعی ما را نمی‌بیند. چالش اصلی آن، پیدا کردن یک "هاست زامبی" مناسب در اینترنت امروزی است، زیرا اکثر سیستم‌عامل‌های مدرن دیگر از IPID افزایشی و قابل پیش‌بینی استفاده نمی‌کنند. این تکنیک امروزه بیشتر ارزش آموزشی دارد.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sI <zombie_IP> <target_IP>`

---

##### **۷. UDP Scan (`-sU`)**

> **برداشت من:** این اسکن از پروتکل UDP استفاده می‌کند. اگر پیغام "Port Unreachable" دریافت شود، پورت بسته است. اما درباره باز بودنش ابهام `open|filtered` وجود دارد. کند است اما تنها راه اسکن سرویس‌های مهمی مثل DNS و SNMP است.

🧠 **یادآوری با مثال:**
تکنیک **"ارسال کارت پستال برای تمام دفاتر"**. دریافت یک نامه برگشتی ("گیرنده یافت نشد") به معنی بسته بودن قطعی دفتر است. اما عدم دریافت پاسخ، هم می‌تواند به معنی باز بودن دفتر باشد و هم از بین رفتن نامه توسط نگهبان (فایروال).

⚙️ **منطق فنی و استراتژی:**
اسکن UDP به دلیل ماهیت بدون اتصال و غیرقابل اعتماد UDP، ذاتاً کند و مبهم است. با این حال، برای شناسایی سرویس‌های حیاتی که فقط روی این پروتکل اجرا می‌شوند، **اجباری** است. برای افزایش دقت، همیشه بهتر است این اسکن را با تشخیص نسخه ترکیب کنید (`-sU -sV`) تا با ارسال بسته‌های هوشمندانه‌تر، پاسخ‌های قطعی‌تری از سرویس‌های باز دریافت کنید.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sU <target>`

---

##### **۸. SCTP COOKIE ECHO Scan (`-sZ`)**

> **برداشت من:** این برای پروتکل مخابرات (SCTP) است. Nmap یک پکت با چانک بی‌معنی (`COOKIE ECHO`) می‌فرستد. اگر پورت بسته باشد، جواب `ABORT` می‌گیرد، اما اگر باز باشد، سکوت می‌کند و ابهام `open|filtered` به وجود می‌آید.

🧠 **یادآوری با مثال:**
تکنیک **"بررسی اعتبار کد رهگیری"**. شما یک کد رهگیری تقلبی برای یک سرویس پستی مدرن (SCTP) ارسال می‌کنید. اگر دفتر بسته باشد، اداره پست مرکزی با یک پیام "لغو عملیات" (`ABORT`) پاسخ می‌دهد. اگر دفتر باز باشد، کارمند داخل دفتر کد تقلبی شما را در سکوت نادیده می‌گیرد.

⚙️ **منطق فنی و استراتژی:**
این یک روش نسبتاً مخفیانه برای اسکن پروتکل مدرن SCTP است که در شبکه‌های مخابراتی (VoIP) کاربرد دارد. این روش از مکانیزم داخلی کوکی در SCTP برای استنباط وضعیت پورت استفاده می‌کند و از اسکن کامل (`-sY`) که یک ارتباط کامل برقرار می‌کند، کم سر و صداتر است.

⚡️ **دستور اصلی (Command):**
`sudo nmap -sZ <target>`
























**nmap -sU -p 1930 --script ssdp-info 192.168.1.0/24 (SSDP) : این خیلی جالبه . جوریک ه من متوجه شدم میاد روی پروتوکل یو دی پی یه فرخوان میفرسته برای کل شبکه محلی تا همه دستگاه ها خودشون رو بهش معرفی کنن 












